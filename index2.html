<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corporate Flow Chart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the LLC boxes */
        .llc-box {
            @apply bg-blue-600 text-white p-4 rounded-lg shadow-xl flex flex-col items-center justify-center text-center transition-all duration-300 ease-in-out;
            min-width: 180px; /* Minimum width for readability */
            min-height: 100px; /* Minimum height */
            margin: 1rem; /* Spacing between boxes */
            position: relative; /* Needed for positioning relative to the container for line calculations */
            font-family: 'Inter', sans-serif; /* Consistent font */
        }

        .llc-box h3 {
            @apply font-bold text-lg mb-1;
        }

        .llc-box p {
            @apply text-sm opacity-90;
        }

        /* Specific colors for different levels */
        #apex-holdings { @apply bg-blue-700; }
        .operational-llc { @apply bg-green-600; }
        .asset-llc { @apply bg-purple-600; }
        #hr-it-services { @apply bg-yellow-600; }

        /* General container styling for centering and responsiveness */
        body {
            @apply bg-gray-100 flex items-center justify-center min-h-screen p-4;
        }

        #chart-container {
            @apply relative w-full max-w-6xl mx-auto flex flex-col items-center justify-center;
        }

        /* SVG styling for lines */
        #flowChartLines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Ensure lines are behind boxes */
        }
    </style>
</head>
<body>
    <div id="chart-container">
        <svg id="flowChartLines"></svg>

        <div id="apex-holdings" class="llc-box">
            <h3>Apex Holdings LLC</h3>
            <p>Overall Strategic Direction</p>
        </div>

        <div class="flex flex-col md:flex-row justify-center items-stretch mt-8 md:mt-16 w-full">
            <div id="core-operations" class="llc-box operational-llc flex-1">
                <h3>Core Operations LLC</h3>
                <p>Primary Business Activities</p>
            </div>
            <div id="marketing-sales" class="llc-box operational-llc flex-1">
                <h3>Marketing & Sales LLC</h3>
                <p>Marketing & Sales Campaigns</p>
            </div>
            <div id="research-development" class="llc-box operational-llc flex-1">
                <h3>Research & Development LLC</h3>
                <p>New Product Innovation</p>
            </div>
        </div>

        <div class="flex flex-col md:flex-row justify-center items-stretch mt-8 md:mt-16 w-full">
            <div id="property-management" class="llc-box asset-llc flex-1">
                <h3>Property Management LLC</h3>
                <p>Real Estate Assets</p>
            </div>
            <div id="intellectual-property" class="llc-box asset-llc flex-1">
                <h3>Intellectual Property LLC</h3>
                <p>Patents, Trademarks, Copyrights</p>
            </div>
        </div>

        <div class="flex justify-center mt-8 md:mt-16 w-full">
            <div id="hr-it-services" class="llc-box flex-none">
                <h3>HR & IT Services LLC</h3>
                <p>Centralized HR & IT</p>
            </div>
        </div>
    </div>

    <script>
        // Function to draw lines between the LLC boxes
        function drawLines() {
            const svg = document.getElementById('flowChartLines');
            if (!svg) {
                console.error("SVG element not found.");
                return;
            }

            // Clear any existing lines before redrawing
            while (svg.firstChild) {
                svg.removeChild(svg.firstChild);
            }

            const chartContainer = document.getElementById('chart-container');
            if (!chartContainer) {
                console.error("Chart container not found.");
                return;
            }

            // Get the bounding rectangle of the chart container to calculate relative positions
            const containerRect = chartContainer.getBoundingClientRect();

            // Helper function to get the center point of the bottom edge of an element
            const getBoxBottomCenter = (id) => {
                const element = document.getElementById(id);
                if (!element) return null;
                const rect = element.getBoundingClientRect();
                return {
                    x: rect.left + rect.width / 2 - containerRect.left,
                    y: rect.bottom - containerRect.top
                };
            };

            // Helper function to get the center point of the top edge of an element
            const getBoxTopCenter = (id) => {
                const element = document.getElementById(id);
                if (!element) return null;
                const rect = element.getBoundingClientRect();
                return {
                    x: rect.left + rect.width / 2 - containerRect.left,
                    y: rect.top - containerRect.top
                };
            };

            // Helper function to create and append an SVG line
            const createLine = (startX, startY, endX, endY, color = '#3B82F6', strokeWidth = 2) => {
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', startX);
                line.setAttribute('y1', startY);
                line.setAttribute('x2', endX);
                line.setAttribute('y2', endY);
                line.setAttribute('stroke', color);
                line.setAttribute('stroke-width', strokeWidth);
                line.setAttribute('marker-end', 'url(#arrowhead)'); // Add arrowhead marker
                svg.appendChild(line);
            };

            // Define SVG arrowhead marker
            const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
            const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
            marker.setAttribute('id', 'arrowhead');
            marker.setAttribute('markerWidth', '10');
            marker.setAttribute('markerHeight', '7');
            marker.setAttribute('refX', '0');
            marker.setAttribute('refY', '3.5');
            marker.setAttribute('orient', 'auto');
            const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            polygon.setAttribute('points', '0 0, 10 3.5, 0 7');
            polygon.setAttribute('fill', '#3B82F6');
            marker.appendChild(polygon);
            defs.appendChild(marker);
            svg.appendChild(defs);

            // Get positions of all relevant boxes
            const apex = getBoxBottomCenter('apex-holdings');
            const coreOps = getBoxTopCenter('core-operations');
            const marketing = getBoxTopCenter('marketing-sales');
            const research = getBoxTopCenter('research-development');
            const property = getBoxTopCenter('property-management');
            const ip = getBoxTopCenter('intellectual-property');
            const hrIt = getBoxTopCenter('hr-it-services');

            // Draw lines from Apex Holdings to all direct subsidiaries
            if (apex) {
                if (coreOps) createLine(apex.x, apex.y, coreOps.x, coreOps.y);
                if (marketing) createLine(apex.x, apex.y, marketing.x, marketing.y);
                if (research) createLine(apex.x, apex.y, research.x, research.y);
                if (property) createLine(apex.x, apex.y, property.x, property.y);
                if (ip) createLine(apex.x, apex.y, ip.x, ip.y);
                if (hrIt) createLine(apex.x, apex.y, hrIt.x, hrIt.y);
            }
        }

        // Call drawLines when the window loads and on resize to ensure lines are correctly positioned
        window.addEventListener('load', () => {
            // A small delay to ensure all elements are rendered and their positions are stable
            setTimeout(drawLines, 50);
        });
        window.addEventListener('resize', () => {
            // Re-draw lines on window resize to adjust to new element positions
            drawLines();
        });
    </script>
</body>
</html>

